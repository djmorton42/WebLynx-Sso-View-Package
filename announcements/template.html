<!DOCTYPE html>
<html>
  <head>
    <link rel="icon" type="image/png" href="/views/announcements/sso-logo.png">
    <link rel="stylesheet" href="/views/announcements/styles.css">
  </head>
  <body>
    <div class="announcement-overlay">
      <!-- Header Section -->
      <div class="header-section">
        <div class="meet-info">
          <div class="meet-title" id="meet-title">{{MEET_TITLE}}</div>
          <div class="event-subtitle" id="event-subtitle">{{EVENT_SUBTITLE}}</div>
        </div>
        <div class="sso-logo">
          <img src="/views/announcements/sso-logo.png" alt="SSO Logo" />
        </div>
      </div>
      
      <!-- Main Content Area -->
      <div class="announcement-content">
        <div class="announcement-message" id="announcement-message" style="display: none;">
          <div class="loading">Loading announcement...</div>
        </div>
      </div>
      
      <!-- Sponsors Banner -->
      <div class="sponsors-banner">
        <div class="sponsors-text">Thank you to our partners</div>
        <div class="sponsors-logos">
          <img src="/views/announcements/sponsors/cao.avif" alt="CAO" class="sponsor-logo" />
          <img src="/views/announcements/sponsors/csi.avif" alt="CSI" class="sponsor-logo" />
          <img src="/views/announcements/sponsors/nagano.avif" alt="Nagano" class="sponsor-logo" />
          <img src="/views/announcements/sponsors/ontario.avif" alt="Ontario" class="sponsor-logo" />
        </div>
      </div>
    </div>
    
    <script>
      // Configuration
      const UPDATE_INTERVAL = 2000; // milliseconds
      
      function updateAnnouncementData() {
        fetch('/api/race/race-data')
          .then(response => {
            if (!response.ok) {
              throw new Error(`HTTP error! status: ${response.status}`);
            }
            return response.json();
          })
          .then(data => {
            // The meet title and event subtitle are set from configuration and don't change dynamically
            // The meet title should always be "Ontario Elite Circuit Meet #1" from BroadcastSettings.MeetTitle
            // The event subtitle should always be "September 27-28, 2025" from BroadcastSettings.EventSubtitle
            
            // Update announcement message
            const announcementElement = document.getElementById('announcement-message');
            
            if (data.announcementMessage && data.announcementMessage.trim()) {
              announcementElement.innerHTML = data.announcementMessage;
              announcementElement.className = 'announcement-message';
              announcementElement.style.display = 'block';
            } else {
              announcementElement.style.display = 'none';
            }
          })
          .catch(error => {
            console.error('Error fetching race data:', error);
            const announcementElement = document.getElementById('announcement-message');
            announcementElement.style.display = 'none';
          });
      }
      
      // Start updating
      updateAnnouncementData(); // Initial load
      setInterval(updateAnnouncementData, UPDATE_INTERVAL);
    </script>
  </body>
</html>
